import{C as b,e as A,n as t,D as o,d as S,c as d,p as f,k as E,a as k,E as v,o as w}from"./index-CEP2_6OW.js";const F=b("permissions",()=>{const n=A(),e=t(()=>n.is("admin")),r=t(()=>n.is("partner_manager")),s=t(()=>n.is("asset_governance")),a=t(()=>n.is("viewer")),i=(c,m)=>!!(e.value||r.value&&c===n.userCompanyId||s.value||a.value),l=c=>!!(e.value||r.value||s.value),u=c=>l(),p=c=>e.value,g=t(()=>e.value||r.value),y=t(()=>e.value),_=t(()=>e.value||r.value),C=t(()=>e.value),h=t(()=>{switch(n.userRole){case"admin":return 4;case"partner_manager":return 3;case"asset_governance":return 2;case"viewer":return 1;default:return 0}});return{isAdmin:e,isPartnerManager:r,isAssetGovernance:s,isViewer:a,canSeeAsset:i,canManageAsset:l,canEditAsset:u,canDeleteAsset:p,canSeeCompanies:g,canManageUsers:y,canSeeReports:_,canAccessSettings:C,permissionLevel:h,hasPermissionLevel:c=>{const m={admin:4,partner_manager:3,asset_governance:2,viewer:1};return h.value>=m[c]}}});class U{static async listVisibleAssets(){try{const{data:e,error:r}=await o.from("v_my_assets").select("*").order("created_at",{ascending:!1});if(r)throw r;return e||[]}catch(e){throw console.error("Erro ao listar ativos:",e),new Error("Erro ao carregar ativos")}}static async getAssetById(e){try{const{data:r,error:s}=await o.from("assets").select("*").eq("id",e).single();if(s){if(s.code==="PGRST116")return null;throw s}return r}catch(r){throw console.error("Erro ao buscar ativo:",r),new Error("Erro ao carregar ativo")}}static async getCompanyById(e){try{const{data:r,error:s}=await o.from("companies").select("*").eq("id",e).single();if(s){if(s.code==="PGRST116")return null;throw s}return r}catch(r){throw console.error("Erro ao buscar empresa:",r),new Error("Erro ao carregar empresa")}}static async listCompanies(){try{const{data:e,error:r}=await o.from("companies").select("*").order("name");if(r)throw r;return e||[]}catch(e){throw console.error("Erro ao listar empresas:",e),new Error("Erro ao carregar empresas")}}static async getUserAssets(e){var r;try{const{data:s,error:a}=await o.from("user_assets").select("*").eq("user_id",e||((r=(await o.auth.getUser()).data.user)==null?void 0:r.id));if(a)throw a;return s||[]}catch(s){throw console.error("Erro ao buscar vínculos do usuário:",s),new Error("Erro ao carregar vínculos")}}static async createAsset(e){try{const{data:r,error:s}=await o.from("assets").insert(e).select().single();if(s)throw s;return r}catch(r){throw console.error("Erro ao criar ativo:",r),new Error("Erro ao criar ativo")}}static async updateAsset(e,r){try{const{data:s,error:a}=await o.from("assets").update(r).eq("id",e).select().single();if(a)throw a;return s}catch(s){throw console.error("Erro ao atualizar ativo:",s),new Error("Erro ao atualizar ativo")}}static async deleteAsset(e){try{const{error:r}=await o.from("assets").delete().eq("id",e);if(r)throw r}catch(r){throw console.error("Erro ao deletar ativo:",r),new Error("Erro ao deletar ativo")}}static async linkUserToAsset(e,r,s="viewer"){try{const{error:a}=await o.from("user_assets").insert({user_id:e,asset_id:r,role:s});if(a)throw a}catch(a){throw console.error("Erro ao vincular usuário ao ativo:",a),new Error("Erro ao vincular usuário")}}static async unlinkUserFromAsset(e,r){try{const{error:s}=await o.from("user_assets").delete().eq("user_id",e).eq("asset_id",r);if(s)throw s}catch(s){throw console.error("Erro ao desvincular usuário do ativo:",s),new Error("Erro ao desvincular usuário")}}}const q={key:0,class:"px-6 py-4 border-b border-[#E8ECEF]"},B={key:1,class:"px-6 py-4 border-t border-[#E8ECEF] bg-[#E8ECEF]/20"},$=S({__name:"Card",props:{padding:{default:"md"},shadow:{default:"sm"},hover:{type:Boolean,default:!1},clickable:{type:Boolean,default:!1}},setup(n){const e=n,r=t(()=>{const a="bg-white rounded-lg border border-[#E8ECEF] overflow-hidden",i={none:"",sm:"shadow-sm",md:"shadow-md",lg:"shadow-lg"},l=e.hover?"hover:shadow-md transition-shadow duration-200":"",u=e.clickable?"cursor-pointer hover:scale-[1.02] transition-transform duration-200":"";return[a,i[e.shadow],l,u].join(" ")}),s=t(()=>({none:"",sm:"p-4",md:"p-6",lg:"p-8"})[e.padding]);return(a,i)=>(w(),d("div",{class:f(r.value)},[a.$slots.header?(w(),d("div",q,[v(a.$slots,"header")])):E("",!0),k("div",{class:f(s.value)},[v(a.$slots,"default")],2),a.$slots.footer?(w(),d("div",B,[v(a.$slots,"footer")])):E("",!0)],2))}});export{U as A,$ as _,F as u};
